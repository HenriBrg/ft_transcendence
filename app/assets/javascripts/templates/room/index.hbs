<div id="roomIndexPage">

</div>

<br>
<p> Hi {{user.nickname}}, let's talk !</p><br>

<a class="btn btn-primary" href="#room/new" role="button">Create a new room</a>
<br><br>

<br>
{{!-- Every Rooms from DB except whoses which are owned by current user  --}}
<div>

    <ul class="list-group">
        {{!-- https://stackoverflow.com/questions/27719071/nested-if-inside-each-handlebars-template-in-express-app --}}
        
        {{!-- Flemme CSS --}}

        <p>  &nbsp; &nbsp;  <mark> Owned Rooms </mark> </p>
        {{#each roomJoinedAsOwner}}
        {{!-- roomJoinedAsOwner --}}
            <li class="list-group-item"> {{name}} {{privacy}} 
            <a style="font-size: 14px;" href="#rooms/{{id}}">Open</a>
            <a style="font-size: 14px;" href="#room/edit/{{id}}">Edit</a>
            </li>
            <br>
        {{/each}}

        <p>  &nbsp; &nbsp;  <mark> Administrated Rooms </mark> </p>

        {{#each roomJoinedAsRoomAdmin}}
        {{!-- roomJoinedAsRoomAdmin --}}
            <li class="list-group-item"> {{name}} {{privacy}}
            <a style="font-size: 14px;" href="#rooms/{{id}}">Open</a>
            </li> <br>
        {{/each}}

        <p>  &nbsp; &nbsp;  <mark> Member Rooms </mark> </p>

        {{#each roomJoinedAsMember}}
        {{!-- roomJoinedAsMember --}}
            <li class="list-group-item"> {{name}} {{privacy}}
            <a style="font-size: 14px;" href="#rooms/{{id}}">Open</a>
            </li><br>
        {{/each}}

        <p>  &nbsp; &nbsp;  <mark> Unjoined Rooms </mark> </p>

        {{#each notJoinedRooms}}
        {{!-- notJoinedRooms --}}
            <li class="list-group-item"> {{name}} {{privacy}} :
            {{#when privacy "eq" "private" }}
                <form class="privateRoomAuthForm" id="privateRoomAuthForm-{{id}}" style="display: inline;" id="{{../privateForm.formID}}" action="/api/rooms/joinPrivate.json" accept-charset="UTF-8" method="{{../privateForm.method}}">
                    <input type="hidden" name="authenticity_token" value="{{../privateForm.token}}">
                    <label for="roomPassword">Password : </label>
                    <input type="text" class="privateRoomAuthFormField" id="roomPassword" name="room[password]">
                    <input type="hidden" id="roomOwner" name="room[owner_id]" value="{{owner_id}}">
                    <input type="hidden" id="roomID" name="room[room_id]" value="{{id}}">
                    <input type="submit" value="{{../privateForm.submitText}}">
                </form>
            {{/when}}

            {{#when privacy "noteq" "private" }}
                <form class="publicRoomJoinForm" id="publicRoomJoinForm-{{id}}" style="display: inline;" action="/api/rooms/joinPublic.json" accept-charset="UTF-8" method="{{../publicForm.method}}">
                    <input type="hidden" name="authenticity_token" value="{{../publicForm.token}}">
                    <input type="hidden" id="roomID" name="room[room_id]" value="{{id}}">
                    <input type="hidden" id="roomOwner" name="room[owner_id]" value="{{owner_id}}">
                    <input class="btn btn-primary" type="submit" value="{{../publicForm.submitText}}">
                </form>
            {{/when}}
            </li>
            <br>
        {{/each}}
        
        <br>

    </ul>
</div>